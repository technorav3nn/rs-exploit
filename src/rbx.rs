use std::{ffi::CString, mem::transmute, os::raw::c_char};

#[allow(deprecated)]
use mach_o_sys::dyld::_dyld_get_image_vmaddr_slide;

type RPrint = extern "C" fn(mode: i32, message: *const c_char);

#[allow(deprecated)]
pub unsafe fn rbx_printf(mode: i32, message: &str) {
    let func_address = 0x0100BAEA4D;
    let ptr = (_dyld_get_image_vmaddr_slide(0) + func_address) as *const ();

    let print = transmute::<*const (), RPrint>(ptr);

    println!("print: {:p}", print);

    let msg = CString::new(message).unwrap();
    print(mode, msg.as_ptr());
}

pub unsafe fn get_lua_state() {}
